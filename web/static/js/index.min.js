var base,editor;function import$(t,e){var n,r={}.hasOwnProperty;for(n in e)r.call(e,n)&&(t[n]=e[n]);return t}base="https://xlfont.maketext.io/links",(editor={init:function(){var a=this;return this.ldcv=new ldcover({root:document.querySelector(".ldcv")}),this.ldld=new ldloader({root:document.querySelector(".ldcv .inner .ld")}),this.gldcv=new ldcover({root:ld$.find("#gloader",0),lock:!0}),this.gld=new ldloader({root:ld$.find("#gloader",0),toggler:function(t){return a.gldcv.toggle(t)}}),this.svg=document.querySelector("svg"),this.path=document.querySelector("path"),this.textarea=document.querySelector("textarea"),this.textarea.addEventListener("keyup",function(){return a.sync()}),this.workerCfg={useWorker:{url:"/assets/lib/@xlfont/load/dev/worker.min.js",opentypeUrl:"/assets/lib/@plotdb/opentype.js/main/opentype.min.js"}},document.querySelector("#chooser").addEventListener("click",function(t){var e,n,r,o;if(t&&t.target)return"svg"===t.target.getAttribute("data-target")?a.toSvg():(e=ld$.parent(t.target,"[data-font]",document.querySelector("#chooser")))&&(t=["data-font","data-type","data-weight"].map(function(t){return e.getAttribute(t)}),n=t[0],r=t[1],o=t[2],n)?(a.gld.on(),debounce(350).then(function(){return"en"!==r?a.load(n,o):xfl.load(import$({path:base+"/"+n+"/normal/"+o+".ttf",weight:o,style:"normal"},a.workerCfg)).then(function(t){return a.font=t,a.sync()})}).then(function(){return console.log("loaded"),a.gld.off()})):void 0}),this.gld.on(),debounce(350).then(function(){var t=a.load("Klee One"),e=xfl.load({path:base+"/SoukouMincho/normal/400"}).then(function(e){var t=Array.from(document.querySelectorAll("h1,h2,h3")),n=t.map(function(t){return t.innerText}).join("");return e.sync(n).then(function(){return t.map(function(t){return t.classList.add(e.className)})})});return Promise.all([e,t])}).then(function(){return console.log("inited."),a.gld.off()})},toSvg:function(){var o=this;return this.ldld.on().then(function(){return o.ldcv.toggle()}).then(function(){return o.font.getPath({text:o.textarea.value.replace("s/g"," "),x:0,y:0,fontSize:48})}).then(function(t){var e=t.getBoundingBox(),n=t.toPathData(),r=o.svg.getBoundingClientRect(),t=r.width/2-(e.x2-e.x1)/2-e.x1,e=r.height/2-(e.y2-e.y1)/2-e.y1;return o.path.setAttribute("d",n),o.path.setAttribute("transform","translate("+t+", "+e+")")}).then(function(){return o.ldld.off()})},load:function(t,e,n){var r=this;return null==e&&(e=400),null==n&&(n="normal"),xfl.load(import$({path:base+"/"+t+"/"+n+"/"+e,weight:e,style:n,doMerge:!0},this.workerCfg)).then(function(t){return r.font=t,r.font.sync(document.body.innerText)}).then(function(){return r.sync()})},sync:function(){if(this.font)return this.font.sync(this.textarea.value),this.textarea.setAttribute("class","form-control "+this.font.className),document.body.setAttribute("class",this.font.className+"")}}).init();